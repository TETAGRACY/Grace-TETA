---
title: "Class2"
output: html_document
date: "2025-10-16"
---

NAME: Grace TETA
ID: 101378
CLASS 2
--------------------------------------------------------------
### Data management
###  Data Visualization and Data management
###  Test to treat data
```{r}
 data1 <- read.table(text="
ID Sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
1 4 6 30 140 67 47 23 39 134 80
2 10 2 29 164 72 81 28 63 211 132
", header = TRUE)

```
```{r}
 barplot(as.matrix(data1),main="Confirmed cases Vs Gender",beside=TRUE,col=c("gold3","red"))
legend("topright", c("Male","Female"),cex = 0.5,bty="n",fill = c("gold3
 ","red"))
```
```{r}
data3 <- read.table(text="
ID sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
1 867 582 1802 12003 3059 9205 5346 7269 5933 3245
2 842 436 1805 11785 3508 10908 4902 7883 5901 4646
", header = TRUE)

```
```{r}
barplot(as.matrix(data3),main=" COVID 19 test Vs Gender",beside=TRUE,col=c("blue","purple"))
 legend("topleft", c("Male","Female"),cex = 1.3,bty="n",fill = c("blue",
 "purple"))
```
```{r}
data2 <- read.table(text="
ID Sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
1 0 0 1 9 8 7 1 4 11 22
2 11 3 41 242 104 78 44 86 244 147
3 3 5 17 53 27 43 6 12 90 43
", header = TRUE)
```
```{r}
barplot(as.matrix(data2),main="Confirmed cases Vs Age categories",beside=TRUE,col=c("green","blue","purple"))

barplot(as.matrix(data2),main="Confirmed cases Vs Age categories",beside=TRUE,col=c("green","blue","purple"))

legend(
  "topleft",
  c("Less than 15 years", "15â€“49 years", "Above 50"),
  cex = 1.3,
  bty = "n",
  fill = c("green", "blue", "purple")
)


```
```{r}
months<-c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan_2023","Feb
 _2023","Mar_2023","Apr_2023","May_2023","June_2023")

Confirmed_covid<-c(14,8,59,304,139,128,51,102,345,212)

plot(Confirmed_covid, type = "l",pch=21, col = "red",ylim=c(0,350),
 xaxt="n", ylab = "Number of patients ",
 main = "Confirmed cases Vs treatment ")

treatment<- c(12,0,26,217,104,57,12,47,23,20)

lines(treatment, col="blue",lty=2)

legend("topleft", legend=c("Received treatment", "Confirmed"),cex=0.5,
 fill = c("blue","red"))

 axis(1,at=1:10,lab=c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan
 _2023","Feb_2023","Mar_2023","Apr_2023","May_2023","June_2023"))

```
```{r}
months<-c("sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan_2023","feb
 _2023","Mar_2023","Apr_2023","May_2023", "June_2023")
 number_of_test<-c(1709, 1018, 3607,23788,6567,20113,10248,15152,11834,
 7891)
 
 plot(number_of_test, type = "o", col = "blue",ylim=c(0,24000),
 xaxt="n", ylab = "Number of Test",
 main = "COVID 19 Test")
 
 axis(1,at=1:10,lab=c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan
 _2023","Feb_2023","Mar_2023","Apr_2023","May_2023","June_2023"))

```
### ggplot2
###  Library ggplot2
### install.packages("ggplot2")

```{r}
library(ggplot2)
```

```{r}
data("mtcars")
```

```{r}
#dotchart(mtcars$mpg,labels=row.names(mtcars),ce#x = 0.,main="miles perGallon of car model",xlab = "MPG")

table(mtcars$cyl)
```
```{r}
#barplot(mtcars$cyl)
barplot(table(mtcars$cyl),main="Distribution of car Cylinder counts",xlab="Number of cylinders",ylab = "Number of cars")

```
```{r}
barplot(table(mtcars$cyl),main="Distribution of car Cylinder counts",xlab="Number of cylinders",ylab = "Number of cars",horiz=TRUE)

```
```{r}
plot(mtcars$mpg~mtcars$wt,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
```
```{r}
plot(mtcars$mpg~mtcars$wt,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
plot(mtcars$mpg~mtcars$wt,pch=17,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")

```
```{r}
plot(mtcars$mpg~mtcars$wt,pch=21,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")

```
```{r}
plot(mtcars$mpg~mtcars$wt,type="l", lty=2, lwd=2,col="red",main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
```
```{r}
 ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point()+
 labs(title = "Automobile Data",x="Weight",y="Miles per Galon")

```
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg)) +
  geom_point(pch = 17, color = "blue", size = 1) +
  geom_smooth(method = "lm", color = "green") +
  labs(
    title = "Automobile Data",
    x = "Weight",
    y = "Miles per Gallon"
  )
```
```{r}
f0<-ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point(shape=24, fill=1,size=1)+
 geom_smooth(method="lm",color="blue")
 f0
```
```{r}
f1<-f0+theme_bw()
 f1
```
```{r}
f2<-f1+
 theme(panel.grid = element_line(linetype = "dotted",color = "Black"))
 f2
```
### Grouping displays two or more groups of observations in a single plot
```{r}
 data(mtcars)

mtcars$am<-factor(mtcars$am, levels =c(0,1),
 labels= c("Automatic","Manual"))
 mtcars$vs<-factor(mtcars$vs, levels =c(0,1),
 labels=c("V-Engine","Straight Engine"))
 mtcars$cyl<-factor(mtcars$cyl)
 ggplot(data=mtcars,aes(x=hp,y=mpg,shape=cyl,color=cyl))+
 geom_point(size=3)+
 facet_grid(vs~am)+
 labs(title = "Automobile Data by Engine Type",x="HorsePower",y="Miles
 per Gallon")
```
```{r}
data(singer,package="lattice")
 ggplot(singer,aes(x=voice.part,y=height))+geom_boxplot()
```
### cbind and rbind
```{r}
data2<-data.frame(x=1:3,y=c("a","b","c"))
 str(data2)
```
```{r}
 (cbind(data2,data.frame(z=3:1)))
```

```{r}
(rbind(data2,data.frame(x=10,y="z")))
```

### Create another Variable
```{r}
bmi_data <- read.csv("C:\\Users\\USER\\Downloads\\bmi.csv")
variable.names(bmi_data)
```
```{r}
head(bmi_data,n=5)
```
```{r}
tail(bmi_data)

```

```{r}
bmi_data[,1]
```
```{r}
summary(bmi_data$Weight)
```
```{r}
length(bmi_data$Weight)
```
```{r}
bmi_data[,-1]
```
```{r}
 attach(bmi_data)
(Gestational_Diabetes<-Weight/(Height/100)^2) 
```
```{r}
 head(cbind(bmi_data,Gestational_Diabetes))
```
```{r}
tail(cbind(bmi_data,Gestational_Diabetes),n=10)
```
### Summary of BMI
```{r}
summary(Gestational_Diabetes)
```
```{r}
 hist(bmi_data$Height)

```
```{r}
hist(bmi_data$Weight,col = "blue",main = "Sample Histogram")
```
```{r}
stem(Gestational_Diabetes,scale=2)

```
###  Subsetting
### Useof$,[].or[[]]
```{r}
manager<-c(1,2,3,4,5)
country<-c("US","US","UK","UK","UK")
gender<-c("M","F","F","M","F")
age<-c(32,45,25,39,99)
q1<-c(5,3,3,3,2)
q2<-c(4,5,5,3,2)
q3<-c(5,2,5,4,1)
q4<-c(5,5,5,NA,2)
q5<-c(5,5,2,NA,1)
 
leadership<-data.frame(manager,country,gender,age,q1,q2,q3,q4,q5,stringsAsFactors=FALSE)
leadership<-data.frame(manager,country,gender,age,q1,q2,q3,q4,q5)
str(leadership)
```
```{r}
names(leadership)
```
###  Missing value
```{r}
 leadership$age[leadership$age==99]<-NA
 leadership$agecat[leadership$age>75]<-"Elder"
 leadership$agecat[leadership$age>=35&leadership$age<=75]<-"MiddleAged"
 leadership$agecat[leadership$age<35]<-"Young"
```

### One way to handle missing value
```{r}
is.na(leadership[,5:9])
```
```{r}
 newdata<-na.omit(leadership)
 newdata
```

###  Sorting data
```{r}
order(leadership$age)
```
```{r}
newdata2<-leadership[order(leadership$age),]

```
### Merging datasets

###  Subset(selecting variables,dropping variables,selecting observation)
```{r}
 newdata3<-leadership[,c(5:9)]
 myvars<-c("q1","q2","q3","q4","q5")
 newdata3<-leadership[myvars]
 newdata4<-leadership[,c(-1,-2)]
 newdata4<-leadership[,-(1:5)]
 newdata5<-leadership[,c(-1,-7)]
 leadership[[4]]
```
```{r}
leadership$age
```
```{r}
newdata6<-leadership[c(-1,-3),]
 newdata6<-leadership[c(2,4,5),]
 newdata7<-subset(leadership,age>=35|age<24,select=c(q1,q2,q3,q4,q5))
```
```{r}
attach(leadership)
# newdata7 <- leadership[gender="M" & age > 30,]   # incorrect (you fixed this)
newdata7 <- leadership[gender == "M" & age > 30,]  # correct
detach(leadership)
```
### Data management with dyplr
### Thefunctionfilter()
```{r}
 str(flights)
```
```{r}
 #attach(flights)
jan<-filter(flights,month==1)
 jan
```
```{r}
newyear<-filter(flights,month==1,day==1)
 newyear
```
```{r}
 dec25<-filter(flights,month==12,day==25)
 dec25
```
```{r}
jan_dec<-filter(flights,month==1|month==12)
 jan_dec
```
```{r}
 nov_dec<-filter(flights,month%in%c(11,12))
 #detach(flights)
```
### The function arrange()
```{r}
data_10<-arrange(flights,year,month,day)
 arrange(flights,desc(arr_delay))
```
###  The function select
```{r}
 time_var<-select(flights,year,month,day)
 select(flights,year:day)
```
```{r}
 select(flights,-(year:day))
```
### The function mutate
### This is useful in adding a new Variable
```{r}
 ##createasmalldataset
 flights2<-select(flights,year:day,ends_with("delay"),distance,air_time)
 (mutate(flights2,gain=arr_delay-dep_delay,
 speed=distance/air_time*60))
```
### Control structures
###  Grouping
###  Function on R
```{r}
f<-function(x) x^2
 formals(f)
```
```{r}
 body(f)
```
```{r}
 environment(f)
```
### ifelse(test,yes,No)
```{r}
pvalues<-c(.867,0.0054,0.0018,0.1572,0.0183,0.5386)
 results<-ifelse(pvalues<0.05,"Significant","Notsignificant")
 results
```
```{r}
x<-runif(1,0,10)
 if(x>3){
 y<-10
 }else{
 y<-0
 }
```
```{r}
 y<-if(x>3){
 10
 }else{
 0
 }
```
```{r}
 for (i in 1:10) {
  print(i)
}
```
```{r}
x<-c("a","b","c","d")
 x[3]
```
```{r}
 for (i in 1:5) {
  print(x[i])
}

```
```{r}
 for (i in 1:5) print(1:i)
```
```{r}
 for (i in 5:1) print(1:i)
```
###  whileLoops
```{r}
  count <- 1
while (count < 10) {
  print(count)
  count <- count + 1
}
 }
```

```{r}
 z <- 5
set.seed(1)
while (z >= 3 && z <= 10) {
  coin <- rbinom(1, 1, 0.5)
  if (coin == 1) {
    z <- z + 1
  } else {
    z <- z - 1
  }
}
print(z)
```
### next,break
```{r}
for(i in 1:100){
 print(1:i)
 if(i>20){
 break
 }
 }
```
###  Function
```{r}
 f<-function(x,y){
 result<-x+(2*y)+3
 return(result)
 }
f(2,3)
```
###  Exercises
### 1.  Make functions that calculate summary statistics
```{r}
summary_stats <- function(x) {
  mean_x <- mean(x, na.rm = TRUE)
  median_x <- median(x, na.rm = TRUE)
  sd_x <- sd(x, na.rm = TRUE)
  min_x <- min(x, na.rm = TRUE)
  max_x <- max(x, na.rm = TRUE)
  n_missing <- sum(is.na(x))
  
  result <- data.frame(
    Mean = mean_x,
    Median = median_x,
    SD = sd_x,
    Min = min_x,
    Max = max_x,
    Missing = n_missing
  )
  
  return(result)
  data <- c(5, 8, 10, 3, 6, NA, 9)
summary_stats(data)
}
```
```{r}
two_sample_ttest <- function(x, y, equal_var = TRUE) {
  # Perform two-sample t-test
  test_result <- t.test(x, y, var.equal = equal_var)
  
  # Extract key information
  result <- list(
    t_value = test_result$statistic,
    df = test_result$parameter,
    p_value = test_result$p.value,
    mean_x = mean(x, na.rm = TRUE),
    mean_y = mean(y, na.rm = TRUE),
    conclusion = ifelse(test_result$p.value < 0.05,
                        "Reject the null hypothesis: means are significantly different",
                        "Fail to reject the null hypothesis: no significant difference")
  )
  
  return(result)
}
```

### Applying functions to matrices and dataframe.
```{r}
 a<-4
 sqrt(4)
```
```{r}
 b<-c(1,243,5.754,2.987)
 round(b)
```
```{r}
c<-matrix(runif(12),nrow=3)
 c
```
```{r}
 log(c)
```
```{r}
 mean(c)
```
###  lappy function
```{r}
 #df[]<-lappy(df,fix_missing)
#df[1:5]<-lapply(df[1:5],fix_missing)

fix_missing<-function(x){
 x[x==-99]<-NA
 x
 }
 function1<-function(x){
 x^2
 }
 curve(function1,-4,4)
```

### sapply
###  Titanic data
```{r}
 str(Titanic)
```
```{r}
 View(Titanic)
 apply(Titanic,c(1,2),sum)
```
```{r}
options(digits=2)
 apply(Titanic,c(1,2),sum)[3:4,]
```
```{r}
 apply(Titanic,c(1,4),sum)[3:4,]
```
```{r}
 apply(Titanic,c(1,2,4),sum)
```
```{r}
 #apply(Titanic,c(1,2,4),sum)[3:4,]
 apply(Titanic,c(1,2,4),sum)[3:4,,]
```
```{r}
ftable(apply(Titanic,c(1,4,2),sum)[3:4,,])
```
```{r}
 ftable(apply(Titanic,c(1,4,2),sum)[3:4,,])[1:2,]
```
```{r}
ftable(apply(Titanic,c(1,4,2),sum)[3:4,,])[3:4,]

```
```{r}
 digit=2
 prop.table(ftable(apply(Titanic,c(1,4,2),sum)[3:4,,])[1:2,],margin=2)
```
```{r}
prop.table(ftable(apply(Titanic,c(1,4,2),sum)[3:4,,])[3:4,],margin=2)
```
```{r}
 matrix(prop.table(ftable(apply(Titanic,c(1,4,2),sum)[3:4,,])[1:2,],margin=2),nrow=2,dimnames=list(dimnames(Titanic)$Survived,dimnames
 (Titanic)$Sex))
```
```{r}
 matrix(prop.table(ftable(apply(Titanic,c(1,4,2),sum)[3:4,,])[3:4,],margin=2),nrow=2,dimnames=list(dimnames(Titanic)$Survived,dimnames
 (Titanic)$Sex))
```
```{r}
 ###Createdataset
 Student<-c("Johnncuti","Angelabakame","Brucewizeye","Alexisaganze
 ","claudeRukundo","JoelKagabo","Maryineza")
 Math<-c(600,412,358,495,512,410,522)
 Science<-c(95,99,80,82,75,89,77)
 English<-c(25,22,18,20,29,30,27)
 roster<-data.frame(Student,Math,Science,English,stringsAsFactors=FALSE)
```
### standardize variables and obtains the performance scores because they are reported on different scale(With widely differing means and standard deviations,we need to make them comparable before we combine them.)
```{r}
z<-scale(roster[,2:4])
```
### performance of each students using row means and adding them to roster using cbind()
```{r}
score<-apply(z,1,mean)
 roster<-cbind(roster,score)

```
###Grades the students:quantile function gives the percentile rank of each student's performance score check the cut off of A
```{r}
y<-quantile(score,c(.8,.6,.4,.2))
```
```{r}
##createagradevariableus
 roster$grade[score>=y[1]]<-"A"
 roster$grade[score<y[1]&score>=y[2]]<-"B"
 roster$grade[score<y[2]&score>=y[3]]<-"C"
 roster$grade[score<y[3]&score>=y[4]]<-"D"
 roster$grade[score<y[4]]<-"F"
```

#### Dealing with names
```{r}
name<-strsplit((roster$Student),"")
 lastname<-sapply(name,"[",2)
 firstname<-sapply(name,"[",1)
 roster<-cbind(firstname,lastname,roster[,-1])
 roster<-roster[order(lastname,firstname),]
 roster
```

### Aggregation and reshaping
###  transpose
```{r}
cars<-mtcars[1:5,1:4]
 cars
```

```{r}
 t(cars)
```
### aggregate data
```{r}
 options(digits=3)
 attach(mtcars)
 aggdata<-aggregate(mtcars,by=list(cyl,gear),FUN=mean,na.rm=TRUE)
```

### Reshape
```{r}
id<-c(1,1,2,2)
 time<-c(1,2,1,2)
 x1<-c(5,3,6,2)
 x2<-c(6,5,1,4)
 mydata<-data.frame(id,time,x1,x2)
```





